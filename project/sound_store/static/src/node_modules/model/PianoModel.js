var PianoNote = require("./PianoNote");

module.exports = new PianoModel;

function PianoModel(){
    this.notes = [
        new PianoNote("C1", ["C1", "С4"], "C1"),
        new PianoNote("C#1", ["C#1", "С#4"], "C#1"),
        new PianoNote("D1", ["D1", "D4"], "D1"),
        new PianoNote("D#1", ["D#1", "D#4"], "D#1"),
        new PianoNote("E1", ["E1", "E4"], "E1"),
        new PianoNote("F1", ["F1", "F4"], "F1"),
        new PianoNote("F#1", ["F#1", "F#4"], "F#1"),
        new PianoNote("G1", ["G1", "G4"], "G1"),
        new PianoNote("G#1", ["G#1", "G#4"], "G#1"),
        new PianoNote("A1", ["A1", "A4"], "A1"),
        new PianoNote("A#1", ["A#1", "A#4"], "A#1"),
        new PianoNote("B1", ["B1", "B4"], "B1"),

        new PianoNote("C2", ["C2", "С5"], "C2"),
        new PianoNote("C#2", ["C#2", "С#5"], "C#2"),
        new PianoNote("D2", ["D2", "D5"], "D2"),
        new PianoNote("D#2", ["D#2", "D#5"], "D#2"),
        new PianoNote("E2", ["E2", "E5"], "E2"),
        new PianoNote("F2", ["F2", "F5"], "F2"),
        new PianoNote("F#2", ["F#2", "F#5"], "F#2"),
        new PianoNote("G2", ["G2", "G5"], "G2"),
        new PianoNote("G#2", ["G#2", "G#5"], "G#2"),
        new PianoNote("A2", ["A2", "A5"], "A2"),
        new PianoNote("A#2", ["A#2", "A#5"], "A#2"),
        new PianoNote("B2", ["B2", "B5"], "B2"),


        new PianoNote("C3", ["C3", "С6"], "C3"),
        new PianoNote("C#3", ["C#3", "С#6"], "C#3"),
        new PianoNote("D3", ["D3", "D6"], "D3"),
        new PianoNote("D#3", ["D#3", "D#6"], "D#3"),
        new PianoNote("E3", ["E3", "E6"], "E3"),
        new PianoNote("F3", ["F3", "F6"], "F3"),
        new PianoNote("F#3", ["F#3", "F#6"], "F#3"),
        new PianoNote("G3", ["G3", "G6"], "G3"),
        new PianoNote("G#3", ["G#3", "G#6"], "G#3"),
        new PianoNote("A3", ["A3", "A6"], "A3"),
        new PianoNote("A#3", ["A#3", "A#6"], "A#3"),
        new PianoNote("B3", ["B3", "B6"], "B3")
    ];
    this.keyList = ['W', '0', 'R', '1', 'Y', 'I', '2', 'P', '3', 'A', '4', 'S', 'D', '5', 'F', '6', 'G', 'H',
                    '7', 'J', '8', 'K', '9', 'L', 'Z', 'Q', 'X', 'E', 'C', 'V', 'T', 'B', 'U', 'N', 'O', 'M']
}

PianoModel.prototype.getNoteForKey = function(key){
    var result = null;
    //switch(String.fromCharCode(keyCode)){
    switch(key){
        case '0': result = this.__findNoteByDefaultValue("C#1"); break;
        case '1': result = this.__findNoteByDefaultValue("D#1"); break;
        case '2': result = this.__findNoteByDefaultValue("F#1"); break;
        case '3': result = this.__findNoteByDefaultValue("G#1"); break;
        case '4': result = this.__findNoteByDefaultValue("A#1"); break;
        case '5': result = this.__findNoteByDefaultValue("C#2"); break;
        case '6': result = this.__findNoteByDefaultValue("D#2"); break;
        case '7': result = this.__findNoteByDefaultValue("F#2"); break;
        case '8': result = this.__findNoteByDefaultValue("G#2"); break;
        case '9': result = this.__findNoteByDefaultValue("A#2"); break;
        case 'Q': result = this.__findNoteByDefaultValue("C#3"); break;
        case 'E': result = this.__findNoteByDefaultValue("D#3"); break;
        case 'T': result = this.__findNoteByDefaultValue("F#3"); break;
        case 'U': result = this.__findNoteByDefaultValue("G#3"); break;
        case 'O': result = this.__findNoteByDefaultValue("A#3"); break;

        case 'W': result = this.__findNoteByDefaultValue("C1"); break;
        case 'R': result = this.__findNoteByDefaultValue("D2"); break;
        case 'Y': result = this.__findNoteByDefaultValue("E1"); break;
        case 'I': result = this.__findNoteByDefaultValue("F1"); break;
        case 'P': result = this.__findNoteByDefaultValue("G1"); break;
        case 'A': result = this.__findNoteByDefaultValue("A1"); break;
        case 'S': result = this.__findNoteByDefaultValue("B1"); break;
        case 'D': result = this.__findNoteByDefaultValue("C2"); break;
        case 'F': result = this.__findNoteByDefaultValue("D2"); break;
        case 'G': result = this.__findNoteByDefaultValue("E2"); break;
        case 'H': result = this.__findNoteByDefaultValue("F2"); break;
        case 'J': result = this.__findNoteByDefaultValue("G2"); break;
        case 'K': result = this.__findNoteByDefaultValue("A2"); break;
        case 'L': result = this.__findNoteByDefaultValue("B2"); break;
        case 'Z': result = this.__findNoteByDefaultValue("C3"); break;
        case 'X': result = this.__findNoteByDefaultValue("D3"); break;
        case 'C': result = this.__findNoteByDefaultValue("E3"); break;
        case 'V': result = this.__findNoteByDefaultValue("F3"); break;
        case 'B': result = this.__findNoteByDefaultValue("G3"); break;
        case 'N': result = this.__findNoteByDefaultValue("A3"); break;
        case 'M': result = this.__findNoteByDefaultValue("B3"); break;
        default: console.log("wrong key: " + key); break;
    }
    return result;
};

PianoModel.prototype.__findNoteByValue = function(value){
    var i;
    for (i = 0; i < this.notes.length; ++i){
        if(this.notes[i].value === value){
            return this.notes[i];
        }
    }
    return null;
};

PianoModel.prototype.__findNoteByDefaultValue = function(value){
    var i;
    for (i = 0; i < this.notes.length; ++i){
        if(this.notes[i].defaultValue === value){
            return this.notes[i];
        }
    }
    return null;
};

PianoModel.prototype.shift = function(shiftIndex){
    var i;
    for(i = 0; i < this.notes.length; ++i){
        if(shiftIndex >= 0 && shiftIndex < this.notes[i].additionalValue.length)
        this.notes[i].setValueFromAdditional(shiftIndex);
    }
};
